"use strict";angular.module("angular.extras.thirdparty").directive("aeNgTable",["AeNgTableService","$location",function(a,b){return{restrict:"A",scope:{ngTableParams:"=aeNgTable"},link:function(c){var d=c.ngTableParams;c.$on("$locationChangeStart",function(){a.updateParams(d,b.search())})}}}]),angular.module("angular.extras.thirdparty").factory("AeNgTableService",["NgTableParams","$q","$location",function(a,b,c){function d(a,b){if(b.max&&a.count(b.max),b.page&&a.page(b.page),b.sort){var c={};c[b.sort]=b.order||"asc",a.sorting(c)}if(b.filters){var d=b.filters;if("string"==typeof b.filters)try{d=JSON.parse(b.filters)}catch(e){d={},console.error("Error parsing filters.",e)}a.filter(d)}}return{getTableParams:function(e,f,g,h,i){h=h||{};var j={page:1,count:10,sorting:{id:"asc"}};angular.extend(j,f);var k={getData:function(a){var d=a.sorting(),f=Object.keys(d)[0],j=d[f],k={max:a.count(),page:a.page(),filters:a.filter(),sort:f,order:j};if(h.paramsAsURL){var l=angular.copy(k);l.filters=JSON.stringify(l.filters),a.historyReplaced||(c.replace(),a.historyReplaced=!0),c.search(l)}var m=b.defer(),n=angular.extend({},k,g);return e.query(n,function(b,c){var d=c();a.total(d["total-count"]),i&&i(b),b.result?m.resolve(b.result):m.resolve(b)},m.reject),a.dataPromise=m.promise,m.promise}};angular.extend(k,h);var l=new a(j,k);return l.getCurrentSort=function(){var a=this.sorting(),b=Object.keys(a)[0];return{sort:b,order:a[b]}},h.paramsAsURL&&d(l,c.search()),l},updateParams:d}}]);